<!DOCTYPE html>
<html>
<head>
    <title>Test APIs - El Gran Sorteo Gran</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .success { color: green; }
        .error { color: red; }
        pre { background: #f5f5f5; padding: 10px; overflow-x: auto; }
    </style>
</head>
<body>
    <h1>Test de APIs - El Gran Sorteo Gran</h1>
    <div id="results">Cargando pruebas...</div>

    <script>
        const resultsDiv = document.getElementById('results');
        resultsDiv.innerHTML = '';

        async function testAPI(url, name) {
            const startTime = Date.now();
            try {
                console.log(`Testing ${name}:`, url);

                const response = await fetch(url, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Accept': 'application/json'
                    },
                    body: JSON.stringify({})
                });

                const endTime = Date.now();
                const duration = endTime - startTime;

                if (response.ok) {
                    const data = await response.json();
                    resultsDiv.innerHTML += `
                        <div class="success">
                            <h3>✅ ${name}: FUNCIONANDO</h3>
                            <p>Status: ${response.status} | Tiempo: ${duration}ms</p>
                            <details>
                                <summary>Ver datos (click para expandir)</summary>
                                <pre>${JSON.stringify(data, null, 2).substring(0, 1000)}...</pre>
                            </details>
                        </div>
                        <hr>
                    `;
                } else {
                    resultsDiv.innerHTML += `
                        <div class="error">
                            <h3>❌ ${name}: ERROR HTTP</h3>
                            <p>Status: ${response.status} | Tiempo: ${duration}ms</p>
                            <p>Error: ${response.statusText}</p>
                        </div>
                        <hr>
                    `;
                }
            } catch (error) {
                const endTime = Date.now();
                const duration = endTime - startTime;
                console.error(`Error testing ${name}:`, error);

                resultsDiv.innerHTML += `
                    <div class="error">
                        <h3>❌ ${name}: ERROR DE RED/CORS</h3>
                        <p>Tiempo: ${duration}ms</p>
                        <p>Error: ${error.message}</p>
                        <p>Tipo: ${error.name}</p>
                    </div>
                    <hr>
                `;
            }
        }

        async function runTests() {
            resultsDiv.innerHTML = '<p>Ejecutando pruebas...</p>';

            await testAPI('https://test.bizuit.com/agarciaBIZUITDashboardAPI/api/RestFunction/rf_GetNumeros', 'API de Números de Rifa');
            await testAPI('https://test.bizuit.com/agarciaBIZUITDashboardAPI/api/RestFunction/GetDataPremios', 'API de Premios y Ganadores');

            resultsDiv.innerHTML += '<p><strong>Pruebas completadas.</strong></p>';
        }

        // Ejecutar pruebas cuando la página cargue
        runTests();
    </script>
</body>
</html>